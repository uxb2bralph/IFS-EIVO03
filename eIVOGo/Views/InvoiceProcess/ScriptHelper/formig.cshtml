
@using System.IO
@using System.Linq.Expressions

@using eIVOGo.Helper
@using eIVOGo.Models
@using Model.DataEntity
@using Model.Helper
@using Model.Locale
@using Utility
@using Uxnet.Web.WebUI
@{
    ModelSource<InvoiceItem> models;
}

<script>
    $(function () {
        var $postForm;
        var $postFrame = $('<iframe name="dataFrame" width="0" height="0">').appendTo($('body'));
        if (!window.uiInvoiceQuery) {
            window.uiInvoiceQuery = {};
        }
        window.uiInvoiceQuery.C0401 = function () {
            if ($postForm) {
                $postForm.remove();
            }

            $postForm = $('<form method="post" target="dataFrame" />').prop('action', '@(Url.Action("DownloadC0401","InvoiceProcess"))')
                .css('display', 'none').appendTo($('body'));

            $('#theForm').serializeArray().forEach(function (item, index) {
                $('<input type="hidden">')
                    .prop('name', item.name).prop('value',item.value)
                    .appendTo($postForm);
            });
            $postForm.submit();
            //showLoading();
        };

        window.uiInvoiceQuery.C0701 = function () {
            if ($postForm) {
                $postForm.remove();
            }

            $postForm = $('<form method="post" target="dataFrame" />').prop('action', '@(Url.Action("DownloadC0701","InvoiceProcess"))')
                .css('display', 'none').appendTo($('body'));

            $('#theForm').serializeArray().forEach(function (item, index) {
                $('<input type="hidden">')
                    .prop('name', item.name).prop('value',item.value)
                    .appendTo($postForm);
            });
            $postForm.submit();
            //showLoading();
        };
        window.uiInvoiceQuery.C0501 = function () {
            if ($postForm) {
                $postForm.remove();
            }

            $postForm = $('<form method="post" target="dataFrame" />').prop('action', '@(Url.Action("DownloadC0501","InvoiceProcess"))')
                .css('display', 'none').appendTo($('body'));

            $('#theForm').serializeArray().forEach(function (item, index) {
                $('<input type="hidden">')
                    .prop('name', item.name).prop('value',item.value)
                    .appendTo($postForm);
            });
            $postForm.submit();
            //showLoading();
        };
    });
</script>
