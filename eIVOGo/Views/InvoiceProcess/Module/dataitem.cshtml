
@using System.IO
@using System.Linq.Expressions

@using eIVOGo.Helper
@using eIVOGo.Models
@using eIVOGo.Models.ViewModel
@using Model.Models.ViewModel
@using eIVOGo.Controllers
@using Model.DataEntity
@using Model.Helper
@using Model.Locale
@using Utility
@using Uxnet.Web.WebUI

    <td><input name="chkItem" type="checkbox" value="@(_model.InvoiceID)" /></td>
    <td>@(String.Format("{0:yyyy/MM/dd}",_model.InvoiceDate))</td>
    <td>@(_model.InvoiceBuyer.CustomerID)</td>
    <td>@(_model.InvoicePurchaseOrder!=null ? _model.InvoicePurchaseOrder.OrderNo : null)</td>
    <td>@(_model.InvoiceSeller.CustomerName)</td>
    <td>@(_model.InvoiceSeller.ReceiptNo)</td>
    <td><a onclick="showInvoiceModal(@(_model.InvoiceID));">@(_model.TrackCode)@(_model.No)</a></td>
    <td align="right">@(String.Format("{0:0.}",_model.InvoiceAmountType.SalesAmount))</td>
    <td align="right">@(String.Format("{0:0.}",_model.InvoiceAmountType.TaxAmount))</td>
    <td align="right">@(String.Format("{0:0.}",_model.InvoiceAmountType.TotalAmount))</td>
    <td>@(_model.InvoiceWinningNumber!=null ? _model.InvoiceWinningNumber.UniformInvoiceWinningNumber.PrizeType : "N/A")</td>
    <td>@(_model.InvoiceBuyer.IsB2C() ? "" : _model.InvoiceBuyer.ReceiptNo)</td>
    <td>@(_model.InvoiceCancellation==null ? "" : "已作廢")</td>
    <td>@(_model.InvoiceBuyer.CustomerName)</td>
    <td>@(_model.InvoiceBuyer.ContactName)</td>
    <td>@(_model.InvoiceBuyer.Address)</td>
    <td>@(_model.InvoiceBuyer.EMail)</td>
    <td>@(String.Join("", _model.InvoiceDetails.Select(t => t.InvoiceProduct.InvoiceProductItem.FirstOrDefault().Remark)))</td>
    <td>@(_model.CDS_Document.IssuingNotice!=null ? String.Format("{0:yyyy/MM/dd HH:mm:ss}",_model.CDS_Document.IssuingNotice.IssueDate) : "未通知")</td>
    <td>@(_model.InvoiceCarrier!=null ? _model.InvoiceCarrier.CarrierNo : null)</td>
    <td>@(_model.PrintMark)</td>
    <td style="white-space: nowrap;">
        @if (_viewModel.ResultAction == "Process")
            {
                Html.RenderPartial("~/Views/InvoiceProcess/DataAction/DataProcess.ascx", _model);
            }
    </td>


<script runat="server">

    InvoiceItem _model;
    InquireInvoiceViewModel _viewModel;

    protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);
        _model = (InvoiceItem)this.Model;
        _viewModel = (InquireInvoiceViewModel)ViewBag.ViewModel;

    }

</script>
